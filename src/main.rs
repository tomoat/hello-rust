fn main() {
    // println!("Hello, world!");
    greet_world();
    println!("===========================");
    penguin();
    println!("===========================");
    add_one();
    println!("===========================");
    adds();
    println!("===========================");
    // add_one_to_number();
    mutable();
}

fn greet_world() {
    let southern_germany = "GrÃ¼ÃŸ Gott! ğŸ˜Š";
    let chinese = "ä¸–ç•Œï¼Œä½ å¥½ ğŸ˜Š";
    let english = "World, Hello ğŸ˜Š";
    let regions = [southern_germany, chinese, english];

    for regions in regions.iter() {
        println!("{}", regions)
        // println!("{}", &regions)
    }
}

// Rust åŸç”Ÿæ”¯æŒ UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²
// println åé¢çš„ !, åœ¨ Rust ä¸­ï¼Œè¿™æ˜¯ å® æ“ä½œç¬¦ï¼Œä½ ç›®å‰å¯ä»¥è®¤ä¸ºå®æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹å‡½æ•°
// println æ²¡æœ‰ä½¿ç”¨ %s,%d æ¥åšè¾“å‡ºå ä½ç¬¦ï¼Œè€Œæ˜¯ä½¿ç”¨ {},å› ä¸º Rust ä¼šè‡ªåŠ¨è¯†åˆ«è¾“å‡ºæ•°æ®çš„ç±»å‹
// Rust çš„é›†åˆç±»å‹ä¸èƒ½ç›´æ¥è¿›è¡Œå¾ªç¯ï¼Œéœ€è¦å˜æˆè¿­ä»£å™¨(è¿™é‡Œæ˜¯é€šè¿‡ .iter() æ–¹æ³•)ï¼Œæ‰èƒ½ç”¨äºè¿­ä»£å¾ªç¯
// åœ¨ 2021 edition åŠä»¥å, æ”¯æŒç›´æ¥å†™ for region in regionsï¼ŒåŸå› æ˜¯å› ä¸º for éšå¼åœ°å°† regions è½¬æ¢æˆè¿­ä»£å™¨

fn penguin() {
    let penguin_data = "\
    common name,lengthï¼ˆcm)
    little penguin,33
    Yellow-eyed penguin,65
    Fiord-land penguin,60
    invalid,data
    ";
    let records = penguin_data.lines();
    for (i, record) in records.enumerate() {
        if i == 0 || record.trim().len() == 0 {
            continue;
        }

        // å£°æ˜ä¸€ä¸ªfieldså˜é‡ï¼Œç±»å‹æ˜¯Vec
        // Vecæ˜¯vectorçš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©çš„é›†åˆç±»å‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„
        // <_>è¡¨ç¤ºVecä¸­çš„å…ƒç´ ç±»å‹ç”±ç¼–è¯‘å™¨è‡ªè¡Œæ¨æ–­ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œéƒ½ä¼šå¸®æˆ‘ä»¬çœå´ä¸å°‘åŠŸå¤«
        let fields: Vec<_> = record.split(',').map(|field| field.trim()).collect();
        if cfg!(debug_assertions) {
            // è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯è¾“å‡º
            eprintln!("debug: {:?} -> {:?}", record, fields);
        }

        let name = fields[0];
        // 1. å°è¯•æŠŠfields[1]çš„å€¼è½¬æ¢ä¸ºf32ç±»å‹çš„æµ®ç‚¹æ•°ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™æŠŠf32å€¼èµ‹ç»™lengthå˜é‡
        // 2. if letæ˜¯ä¸€ä¸ªåŒ¹é…è¡¨è¾¾å¼ï¼Œç”¨æ¥ä»=å³è¾¹çš„ç»“æœä¸­ï¼ŒåŒ¹é…å‡ºlengthçš„å€¼:
        // å½“=å³è¾¹çš„è¡¨è¾¾å¼æ‰§è¡ŒæˆåŠŸï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªOk(f32)çš„ç±»å‹ï¼Œè‹¥å¤±è´¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªErr(e)ç±»å‹ï¼Œif letçš„ä½œç”¨å°±æ˜¯ä»…åŒ¹é…Okä¹Ÿå°±æ˜¯æˆåŠŸçš„æƒ…
        // å†µ,å¦‚æœæ˜¯é”™è¯¯ï¼Œå°±ç›´æ¥å¿½ç•¥ï¼ŒåŒæ—¶if letè¿˜ä¼šåšä¸€æ¬¡è§£æ„åŒ¹é…ï¼Œé€šè¿‡Ok(length)å»åŒ¹é…å³è¾¹çš„Ok(f32)ï¼Œæœ€ç»ˆæŠŠç›¸åº”çš„f32å€¼èµ‹ç»™length
        // 3. å½“ç„¶ä½ ä¹Ÿå¯ä»¥å¿½è§†æˆåŠŸçš„æƒ…å†µï¼Œç”¨if let Err(e) = fields[1].parse::<f32>() {...}åŒ¹é…å‡ºé”™è¯¯ï¼Œç„¶åæ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯æ²¡å•¥åµç”¨
        if let Ok(length) = fields[1].parse::<f32>() {
            // è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º
            println!("{}, {}cm", name, length);
        }
    }
}

fn add_one() {
    let x = 5;
    let y = 10;
    let sum = x + y;
    println!("The sum of {} and {} is {}", x, y, sum);
}

// åœ¨ Rust ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ if let è¯­å¥æ¥åŒ¹é…å‡ºé”™è¯¯ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™æŠŠé”™è¯¯èµ‹ç»™å˜é‡ eï¼Œç„¶åæ‰“å°å‡ºæ¥
// Rust ç¨‹åºå…¥å£å‡½æ•°å¿…é¡»æ˜¯ fn main()ï¼Œè¿™æ ·æ‰èƒ½è¢«ç¼–è¯‘å™¨è¯†åˆ«ä¸ºä¸»å‡½æ•°ï¼Œè¯¥å‡½æ•°ç›®å‰æ— è¿”å›å€¼ï¼Œä¹Ÿæ— å‚æ•°
// ç”¨letæ¥å£°æ˜å˜é‡ï¼Œå˜é‡çš„ç±»å‹ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ let a = 10ï¼Œä¹Ÿå¯ä»¥ä¸»åŠ¨æŒ‡å®šç±»å‹ let b: i32 = 20ï¼Œå¦‚æœå˜é‡çš„ç±»å‹æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ { } æ¥è§£æ„
// å¯ä»¥åœ¨æ•°å€¼ä¸­å¸¦ä¸Šç±»å‹:30i32è¡¨ç¤ºæ•°å€¼æ˜¯30ï¼Œç±»å‹æ˜¯i32
// let mut c = 30i32 è¡¨ç¤ºcæ˜¯ä¸€ä¸ªå¯å˜çš„æ•´æ•°ï¼Œç±»å‹æ˜¯i32, mutæ˜¯mutableçš„ç¼©å†™è¡¨ç¤ºå¯å˜çš„
// let d = 30_i32 è¿˜èƒ½åœ¨æ•°å€¼å’Œç±»å‹ä¸­é—´æ·»åŠ ä¸€ä¸ªä¸‹åˆ’çº¿ï¼Œè®©å¯è¯»æ€§æ›´å¥½ï¼Œä½†æ˜¯ä¸èƒ½è¢«ç¼–è¯‘å™¨è¯†åˆ«ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨æ•°å€¼ä¸­ä½¿ç”¨ä¸‹åˆ’çº¿ï¼Œä½†æ˜¯å¯ä»¥åœ¨ç±»å‹ä¸­ä½¿ç”¨ä¸‹åˆ’çº¿
// å¯ä»¥ä½¿ç”¨å‡½æ•°è¿”å›å€¼æ¥æ¥æ”¶å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœå‡½æ•°è¿”å›å€¼æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ { } æ¥è§£æ„
// å¯ä»¥ä½¿ç”¨å‡½æ•°è¿”å›å€¼æ¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œå¦‚æœå‡½æ•°è¿”å›å€¼æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ { } æ¥è§£æ„
// println! æ˜¯ä¸€ä¸ªå®ï¼Œå®ƒçš„ä½œç”¨æ˜¯è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼çš„å€¼ä¼šè¢«è¾“å‡ºåˆ°å­—ç¬¦ä¸²ä¸­ï¼Œ å®ƒçœ‹èµ·æ¥åƒæ˜¯å‡½æ•°ä½†æ˜¯å®ƒè¿”å›çš„æ˜¯å®å®šä¹‰çš„ä»£ç å—
// å®å®šä¹‰çš„ä»£ç å—å¯ä»¥åŒ…å«å¤šè¡Œä»£ç ï¼Œå®ƒä»¬ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥ï¼Œå®ƒä»¬åªæ˜¯ä¸ºäº†æé«˜ç¼–è¯‘å™¨çš„æ€§èƒ½ï¼Œå®ƒä»¬ä¸ä¼šè¢«ç¼–è¯‘å™¨è§£æ
// { } æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼æˆ–å ä½ç¬¦ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œå®ƒçš„ç±»å‹æ˜¯è¡¨è¾¾å¼çš„ç±»å‹
// å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å· "" è€Œä¸æ˜¯å•å¼•å· ''ï¼ŒRust ä¸­å•å¼•å·æ˜¯ç•™ç»™å•ä¸ªå­—ç¬¦ç±»å‹ï¼ˆcharï¼‰ä½¿ç”¨çš„
// Rust ä½¿ç”¨ {} æ¥ä½œä¸ºæ ¼å¼åŒ–è¾“å‡ºå ä½ç¬¦ï¼Œå…¶å®ƒè¯­è¨€å¯èƒ½ä½¿ç”¨çš„æ˜¯ %sï¼Œ%dï¼Œ%p ç­‰ï¼Œç”±äº println! ä¼šè‡ªåŠ¨æ¨å¯¼å‡ºå…·ä½“çš„ç±»å‹, å› æ­¤æ— éœ€æ‰‹åŠ¨æŒ‡å®š

fn adds() {
    let a = 10;
    let b: i32 = 20;
    // é€šè¿‡æ·»åŠ åˆ°å®ç”Ÿæˆçš„ä»£ç æ¥æŠ‘åˆ¶è­¦å‘Šï¼š
    #[allow(unused_mut)]
    let mut c = 30i32;
    let d = 30_i32;
    let e = add(add(a, b), add(c, d));
    println!("(a+b)+(c+d) = {}", e);
}

fn add(i: i32, j: i32) -> i32 {
    // è¿”å›ç›¸åŠ å€¼ï¼Œè¿™é‡Œå¯ä»¥å¿½ç•¥returnï¼Œä¸è¦æ·»åŠ ï¼›å·
    i + j
}

fn mutable() {
    let mut a = 10;
    println!("a = {}", a);
    a = 20;
    println!("a = {}", a);

    // å˜é‡é®è”½(shadowing)
    let b = String::from("hello");
    println!("b = {}", b);
    let (a, mut b): (bool, bool) = (true, false);
    // a = true,ä¸å¯å˜; b = falseï¼Œå¯å˜
    println!("a = {:?}, b = {:?}", a, b);

    b = true;
    assert_eq!(a, b);

    // Rust å¸¸é‡çš„å‘½åçº¦å®šæ˜¯å…¨éƒ¨å­—æ¯éƒ½ä½¿ç”¨å¤§å†™ï¼Œå¹¶ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ï¼Œå¦å¤–å¯¹æ•°å­—å­—é¢é‡å¯æ’å…¥ä¸‹åˆ’çº¿ä»¥æé«˜å¯è¯»æ€§
    const MAX_POINTS: u32 = 100_000;
    println!("MAX_POINTS = {}", MAX_POINTS);

    let x = 5;
    // åœ¨å‡½æ•°çš„ä½œç”¨åŸŸå†…å¯¹ä¹‹å‰çš„xè¿›è¡Œé®è”½
    // åœ¨è¢«é®è”½åï¼Œæ— æ³•å†è®¿é—®åˆ°ä¹‹å‰çš„åŒåå˜é‡
    let x = x + 1;
    {
        // åœ¨å½“å‰çš„èŠ±æ‹¬å·ä½œç”¨åŸŸå†…ï¼Œå¯¹ä¹‹å‰çš„xè¿›è¡Œé®è”½
        let x = x * 2;
        println!("The value of x in the inner scope is: {}", x);
    }
    // println!("x = {}", x);
    println!("The value of x is: {}", x);

    // å­—ç¬¦ä¸²ç±»å‹
    let spaces = "   ";
    // usizeæ•°å€¼ç±»å‹
    let spaces = spaces.len();
    // å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ
    println!("spaces = {}", spaces);
}
